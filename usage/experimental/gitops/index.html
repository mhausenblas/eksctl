



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="The official CLI for Amazon EKS">
      
      
      
        <meta name="author" content="eksctl authors">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Experimental - eksctl</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.01803549.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oxygen:300,400,400i,700|Oxygen+Mono&display=fallback">
        <style>body,input{font-family:"Oxygen","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Oxygen Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#gitops" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="eksctl" class="md-header-nav__button md-logo">
          
            <img src="../../../assets/images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              eksctl
            </span>
            <span class="md-header-nav__topic">
              
                Experimental
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/weaveworks/eksctl/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    weaveworks/eksctl
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="eksctl" class="md-nav__button md-logo">
      
        <img src="../../../assets/images/logo.png" width="48" height="48">
      
    </a>
    eksctl
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/weaveworks/eksctl/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    weaveworks/eksctl
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../intro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../gitops-quickstart/" title="GitOps Quickstart" class="md-nav__link">
      GitOps Quickstart
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Usage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Usage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../creating-and-managing-clusters/" title="Creating and managing clusters" class="md-nav__link">
      Creating and managing clusters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../managing-nodegroups/" title="Managing nodegroups" class="md-nav__link">
      Managing nodegroups
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cluster-upgrade/" title="Cluster Upgrades" class="md-nav__link">
      Cluster Upgrades
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../autoscaling/" title="Auto Scaling" class="md-nav__link">
      Auto Scaling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../custom-ami-support/" title="Custom AMI Support" class="md-nav__link">
      Custom AMI Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../vpc-networking/" title="VPC Networking" class="md-nav__link">
      VPC Networking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../gpu-support/" title="GPU Support" class="md-nav__link">
      GPU Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../spot-instances/" title="Spot instances" class="md-nav__link">
      Spot instances
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-9" type="checkbox" id="nav-3-9">
    
    <label class="md-nav__link" for="nav-3-9">
      IAM
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-9">
        IAM
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../iam-permissions-boundary/" title="IAM permissions boundary" class="md-nav__link">
      IAM permissions boundary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../iam-policies/" title="IAM policies" class="md-nav__link">
      IAM policies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../iam-identity-mappings/" title="IAM users and roles" class="md-nav__link">
      IAM users and roles
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../iamserviceaccounts/" title="IAM roles for service sccounts" class="md-nav__link">
      IAM roles for service sccounts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../customizing-the-kubelet/" title="Customizing kubelet configuration" class="md-nav__link">
      Customizing kubelet configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloudwatch-cluster-logging/" title="CloudWatch logging" class="md-nav__link">
      CloudWatch logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../windows-worker-nodes/" title="Windows worker nodes" class="md-nav__link">
      Windows worker nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../eks-managed-nodes/" title="EKS Managed Nodegroups" class="md-nav__link">
      EKS Managed Nodegroups
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fargate-support/" title="EKS Fargate Support" class="md-nav__link">
      EKS Fargate Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../schema/" title="Schema" class="md-nav__link">
      Schema
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Experimental
      </label>
    
    <a href="./" title="Experimental" class="md-nav__link md-nav__link--active">
      Experimental
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing-flux" title="Installing Flux" class="md-nav__link">
    Installing Flux
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-a-workload" title="Adding a workload" class="md-nav__link">
    Adding a workload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-reading" title="Further reading" class="md-nav__link">
    Further reading
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-components-from-a-quick-start-profile" title="Installing components from a Quick Start profile" class="md-nav__link">
    Installing components from a Quick Start profile
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-gitops-in-a-repo-from-a-quick-start" title="Setting up gitops in a repo from a Quick Start" class="md-nav__link">
    Setting up gitops in a repo from a Quick Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-your-own-quick-start-profile" title="Creating your own Quick Start profile" class="md-nav__link">
    Creating your own Quick Start profile
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../examples/reusing-iam-and-vpc/" title="Custom IAM and VPC config" class="md-nav__link">
      Custom IAM and VPC config
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../community/" title="Community" class="md-nav__link">
      Community
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing-flux" title="Installing Flux" class="md-nav__link">
    Installing Flux
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-a-workload" title="Adding a workload" class="md-nav__link">
    Adding a workload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-reading" title="Further reading" class="md-nav__link">
    Further reading
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-components-from-a-quick-start-profile" title="Installing components from a Quick Start profile" class="md-nav__link">
    Installing components from a Quick Start profile
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-gitops-in-a-repo-from-a-quick-start" title="Setting up gitops in a repo from a Quick Start" class="md-nav__link">
    Setting up gitops in a repo from a Quick Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-your-own-quick-start-profile" title="Creating your own Quick Start profile" class="md-nav__link">
    Creating your own Quick Start profile
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/weaveworks/eksctl/edit/master/docs/usage/experimental/gitops.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="gitops">gitops<a class="headerlink" href="#gitops" title="Permanent link">&para;</a></h1>
<p><a href="https://www.weave.works/technologies/gitops/">gitops</a> is a way to do Kubernetes application delivery. It works by using Git as a single source of truth for
Kubernetes resources. With Git at the center of your delivery pipelines, developers can make pull requests to accelerate
and simplify application deployments and operations tasks to Kubernetes.</p>
<p><code>eksctl</code> provides an easy way to set up gitops in an existing cluster with the <code>eksctl enable repo</code> command.</p>
<h3 id="installing-flux">Installing Flux<a class="headerlink" href="#installing-flux" title="Permanent link">&para;</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an experimental feature. To enable it, set the environment variable <code>EKSCTL_EXPERIMENTAL=true</code>.</p>
<p>Experimental features are not stable and their command name and flags may change.</p>
</div>
<p>Installing Flux on the cluster is the first step towards a gitops workflow. To install it, you need a Git repository
and an existing EKS cluster. Then run the following command:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">EKSCTL_EXPERIMENTAL</span><span class="o">=</span><span class="k">true</span> <span class="n">eksctl</span> <span class="n">enable</span> <span class="n">repo</span> <span class="c1">--cluster=&lt;cluster_name&gt; --region=&lt;region&gt; --git-url=&lt;git_repo&gt; --git-email=&lt;git_user_email&gt;</span>
</pre></div>
</td></tr></table>

<p>Or use a config file:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">EKSCTL_EXPERIMENTAL</span><span class="o">=</span><span class="k">true</span><span class="w"> </span><span class="n">eksctl</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">repo</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">examples</span><span class="o">/</span><span class="mi">01</span><span class="o">-</span><span class="n">simple</span><span class="o">-</span><span class="n">cluster</span><span class="p">.</span><span class="n">yaml</span><span class="w"> </span><span class="c1">--git-url=git@github.com:weaveworks/cluster-1-gitops.git --git-email=johndoe+flux@weave.works</span>
</pre></div>
</td></tr></table>

<p>Note that, by default, <code>eksctl enable repo</code> installs <a href="https://helm.sh/">Helm</a> server components to the cluster (it
installs <a href="https://helm.sh/docs/glossary/#tiller">Tiller</a> and the <a href="https://github.com/fluxcd/helm-operator">Flux Helm Operator</a>). To
disable the installation of the Helm server components, pass the flag <code>--with-helm=false</code>.</p>
<p>Full example:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">$</span> <span class="n">EKSCTL_EXPERIMENTAL</span><span class="o">=</span><span class="nb">true</span> <span class="p">.</span><span class="o">/</span><span class="n">eksctl</span> <span class="n">enable</span> <span class="n">repo</span> <span class="o">--</span><span class="n">cluster</span><span class="o">=</span><span class="n">cluster</span><span class="o">-</span><span class="mi">1</span> <span class="o">--</span><span class="n">region</span><span class="o">=</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">2</span>  <span class="o">--</span><span class="n">git</span><span class="o">-</span><span class="n">url</span><span class="o">=</span><span class="n">git</span><span class="p">@</span><span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">weaveworks</span><span class="o">/</span><span class="n">cluster</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">gitops</span><span class="p">.</span><span class="n">git</span>  <span class="o">--</span><span class="n">git</span><span class="o">-</span><span class="n">email</span><span class="o">=</span><span class="n">johndoe</span><span class="o">+</span><span class="n">flux</span><span class="p">@</span><span class="n">weave</span><span class="p">.</span><span class="n">works</span> <span class="o">--</span><span class="n">namespace</span><span class="o">=</span><span class="n">flux</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Generating</span> <span class="n">public</span> <span class="n">key</span> <span class="n">infrastructure</span> <span class="k">for</span> <span class="n">the</span> <span class="n">Helm</span> <span class="n">Operator</span> <span class="n">and</span> <span class="n">Tiller</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>    <span class="n">this</span> <span class="n">may</span> <span class="n">take</span> <span class="n">up</span> <span class="n">to</span> <span class="n">a</span> <span class="n">minute</span><span class="p">,</span> <span class="n">please</span> <span class="n">be</span> <span class="n">patient</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span>  <span class="n">Public</span> <span class="n">key</span> <span class="n">infrastructure</span> <span class="n">files</span> <span class="n">were</span> <span class="n">written</span> <span class="n">into</span> <span class="n">directory</span> <span class="s">&quot;/var/folders/zt/sh1tk7ts24sc6dybr5z9qtfh0000gn/T/eksctl-helm-pki330304977&quot;</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span>  <span class="n">please</span> <span class="n">move</span> <span class="n">the</span> <span class="n">files</span> <span class="n">into</span> <span class="n">a</span> <span class="n">safe</span> <span class="n">place</span> <span class="n">or</span> <span class="n">delete</span> <span class="n">them</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Generating</span> <span class="n">manifests</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Cloning</span> <span class="n">git</span><span class="p">@</span><span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">weaveworks</span><span class="o">/</span><span class="n">cluster</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">gitops</span><span class="p">.</span><span class="n">git</span>
<span class="n">Cloning</span> <span class="n">into</span> <span class="err">&#39;</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">zt</span><span class="o">/</span><span class="n">sh1tk7ts24sc6dybr5z9qtfh0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">eksctl</span><span class="o">-</span><span class="n">install</span><span class="o">-</span><span class="n">flux</span><span class="o">-</span><span class="n">clone</span><span class="o">-</span><span class="mi">142184188</span><span class="err">&#39;</span><span class="p">...</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Enumerating</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">74</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Counting</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">74</span><span class="o">/</span><span class="mi">74</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Compressing</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">55</span><span class="o">/</span><span class="mi">55</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Total</span> <span class="mi">74</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">19</span><span class="p">),</span> <span class="n">reused</span> <span class="mi">69</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">17</span><span class="p">),</span> <span class="n">pack</span><span class="o">-</span><span class="n">reused</span> <span class="mi">0</span>
<span class="n">Receiving</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">74</span><span class="o">/</span><span class="mi">74</span><span class="p">),</span> <span class="mf">30.57</span> <span class="n">KiB</span> <span class="o">|</span> <span class="mf">381.00</span> <span class="n">KiB</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Resolving</span> <span class="nl">deltas</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">19</span><span class="o">/</span><span class="mi">19</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Writing</span> <span class="n">Flux</span> <span class="n">manifests</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Applying</span> <span class="n">manifests</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;Namespace/flux&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Secret/flux-git-deploy&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Deployment.apps/memcached&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:ServiceAccount/flux&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;ClusterRole.rbac.authorization.k8s.io/flux&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;ClusterRoleBinding.rbac.authorization.k8s.io/flux&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:ConfigMap/flux-helm-tls-ca-config&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Deployment.extensions/tiller-deploy&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Service/tiller-deploy&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;CustomResourceDefinition.apiextensions.k8s.io/helmreleases.helm.fluxcd.io&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:ServiceAccount/tiller&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;ClusterRoleBinding.rbac.authorization.k8s.io/tiller&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:ServiceAccount/helm&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Role.rbac.authorization.k8s.io/tiller-user&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;kube-system:RoleBinding.rbac.authorization.k8s.io/tiller-user-binding&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Deployment.apps/flux&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Service/memcached&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Deployment.apps/flux-helm-operator&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:ServiceAccount/flux-helm-operator&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;ClusterRole.rbac.authorization.k8s.io/flux-helm-operator&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;ClusterRoleBinding.rbac.authorization.k8s.io/flux-helm-operator&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Applying</span> <span class="n">Helm</span> <span class="n">TLS</span> <span class="n">Secret</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Secret/flux-helm-tls-cert&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Secret/tiller-secret&quot;</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span>  <span class="nl">Note</span><span class="p">:</span> <span class="n">certificate</span> <span class="n">secrets</span> <span class="n">aren</span><span class="err">&#39;</span><span class="n">t</span> <span class="n">added</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Git</span> <span class="n">repository</span> <span class="k">for</span> <span class="n">security</span> <span class="n">reasons</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Waiting</span> <span class="k">for</span> <span class="n">Helm</span> <span class="n">Operator</span> <span class="n">to</span> <span class="n">start</span>
<span class="nl">ERROR</span><span class="p">:</span> <span class="n">logging</span> <span class="n">before</span> <span class="n">flag</span><span class="p">.</span><span class="nl">Parse</span><span class="p">:</span> <span class="n">E0820</span> <span class="mi">16</span><span class="o">:</span><span class="mo">05</span><span class="o">:</span><span class="mf">12.218007</span>   <span class="mi">98823</span> <span class="n">portforward</span><span class="p">.</span><span class="nl">go</span><span class="p">:</span><span class="mi">331</span><span class="p">]</span> <span class="n">an</span> <span class="n">error</span> <span class="n">occurred</span> <span class="n">forwarding</span> <span class="mi">60356</span> <span class="o">-&gt;</span> <span class="mi">3030</span><span class="o">:</span> <span class="n">error</span> <span class="n">forwarding</span> <span class="n">port</span> <span class="mi">3030</span> <span class="n">to</span> <span class="n">pod</span> <span class="n">b1a872e7e6a7f86567488d66c1a880fcfa26179143115b102041e0ee77fe6f9e</span><span class="p">,</span> <span class="nl">uid</span> <span class="p">:</span> <span class="n">exit</span> <span class="n">status</span> <span class="mi">1</span><span class="o">:</span> <span class="mi">2019</span><span class="o">/</span><span class="mi">08</span><span class="o">/</span><span class="mi">20</span> <span class="mi">14</span><span class="o">:</span><span class="mo">05</span><span class="o">:</span><span class="mi">12</span> <span class="n">socat</span><span class="p">[</span><span class="mi">2873</span><span class="p">]</span> <span class="n">E</span> <span class="n">connect</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">AF</span><span class="o">=</span><span class="mi">2</span> <span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">3030</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span><span class="o">:</span> <span class="n">Connection</span> <span class="n">refused</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span>  <span class="n">Helm</span> <span class="n">Operator</span> <span class="n">is</span> <span class="n">not</span> <span class="n">ready</span> <span class="n">yet</span> <span class="p">(</span><span class="n">Get</span> <span class="nl">http</span><span class="p">:</span><span class="c1">//127.0.0.1:60356/healthz: EOF), retrying ...</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Helm</span> <span class="n">Operator</span> <span class="n">started</span> <span class="n">successfully</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Waiting</span> <span class="k">for</span> <span class="n">Flux</span> <span class="n">to</span> <span class="n">start</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Flux</span> <span class="n">started</span> <span class="n">successfully</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Committing</span> <span class="n">and</span> <span class="n">pushing</span> <span class="n">manifests</span> <span class="n">to</span> <span class="n">git</span><span class="p">@</span><span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">weaveworks</span><span class="o">/</span><span class="n">cluster</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">gitops</span><span class="p">.</span><span class="n">git</span>
<span class="p">[</span><span class="n">master</span> <span class="n">ec43024</span><span class="p">]</span> <span class="n">Add</span> <span class="n">Initial</span> <span class="n">Flux</span> <span class="n">configuration</span>
 <span class="nl">Author</span><span class="p">:</span> <span class="n">Flux</span> <span class="o">&lt;</span><span class="n">johndoe</span><span class="o">+</span><span class="n">flux</span><span class="p">@</span><span class="n">weave</span><span class="p">.</span><span class="n">works</span><span class="o">&gt;</span>
<span class="mi">14</span> <span class="n">files</span> <span class="n">changed</span><span class="p">,</span> <span class="mi">694</span> <span class="n">insertions</span><span class="p">(</span><span class="o">+</span><span class="p">)</span>
<span class="n">Enumerating</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Counting</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">11</span><span class="o">/</span><span class="mi">11</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Delta</span> <span class="n">compression</span> <span class="n">using</span> <span class="n">up</span> <span class="n">to</span> <span class="mi">4</span> <span class="n">threads</span>
<span class="n">Compressing</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">6</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Writing</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">6</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="mf">2.09</span> <span class="n">KiB</span> <span class="o">|</span> <span class="mf">2.09</span> <span class="n">MiB</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Total</span> <span class="mi">6</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">3</span><span class="p">),</span> <span class="n">reused</span> <span class="mi">0</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">0</span><span class="p">)</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Resolving</span> <span class="nl">deltas</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">completed</span> <span class="n">with</span> <span class="mi">3</span> <span class="n">local</span> <span class="n">objects</span><span class="p">.</span>
<span class="n">To</span> <span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">weaveworks</span><span class="o">/</span><span class="n">cluster</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">gitops</span><span class="p">.</span><span class="n">git</span>
   <span class="mf">5f</span><span class="n">e1eb8</span><span class="p">..</span><span class="n">ec43024</span>  <span class="n">master</span> <span class="o">-&gt;</span> <span class="n">master</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Flux</span> <span class="n">will</span> <span class="n">only</span> <span class="n">operate</span> <span class="n">properly</span> <span class="n">once</span> <span class="n">it</span> <span class="n">has</span> <span class="n">write</span><span class="o">-</span><span class="n">access</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Git</span> <span class="n">repository</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">please</span> <span class="n">configure</span> <span class="n">git</span><span class="p">@</span><span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">weaveworks</span><span class="o">/</span><span class="n">cluster</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">gitops</span><span class="p">.</span><span class="n">git</span>  <span class="n">so</span> <span class="n">that</span> <span class="n">the</span> <span class="n">following</span> <span class="n">Flux</span> <span class="n">SSH</span> <span class="n">public</span> <span class="n">key</span> <span class="n">has</span> <span class="n">write</span> <span class="n">access</span> <span class="n">to</span> <span class="n">it</span>
<span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span> <span class="n">AAAAB3NzaC1yc2EAAAADAQABAAABAQDYYsPuHzo1L29u3zhr4uAOF29HNyMcS8zJmOTDNZC4EiIwa5BXgg</span><span class="o">/</span><span class="n">IBDKudxQ</span><span class="o">+</span><span class="n">NBJ7mknPlNv17cqo4ncEq1xiQidfaUawwx3xxtDkZWam5nCBMXEJwkr4VXx</span><span class="o">/</span><span class="mi">6</span><span class="n">QQ9Z1QGXpaFwdoVRcY</span><span class="o">/</span><span class="n">kM4NaxM54pEh5m43yeqkcpRMKraE0EgbdqFNNARN8rIEHY</span><span class="o">/</span><span class="n">giDorCrXp7e6AbzBgZSvc</span><span class="o">/</span><span class="n">in7Ul9FQhJ6K4</span><span class="o">+</span><span class="mi">7</span><span class="n">QuMFpJt3O</span><span class="o">/</span><span class="n">N8KDumoTG0e5ssJGp5L1ugIqhzqvbHdmHVfnXsEvq6cR1SJtYKi2GLCscypoF3XahfjK</span><span class="o">+</span><span class="n">xGV</span><span class="o">/</span><span class="mi">92</span><span class="n">a1E7X</span><span class="o">+</span><span class="mf">6f</span><span class="n">HXSq</span><span class="o">+</span><span class="n">bdOKfBc4Z3f9NBwz0v</span>
</pre></div>
</td></tr></table>

<p>At this point Flux and the Helm server components should be installed in the specified cluster. The only thing left to
do is to give Flux write access to the repository. Configure your repository to allow write access to that ssh key,
for example, through the Deploy keys if it lives in GitHub.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ kubectl get pods --namespace flux
NAME                       READY   STATUS    RESTARTS   AGE
flux-699cc7f4cb-9qc45      <span class="m">1</span>/1     Running   <span class="m">0</span>          29m
memcached-958f745c-qdfgz   <span class="m">1</span>/1     Running   <span class="m">0</span>          29m
</pre></div>
</td></tr></table>

<h4 id="adding-a-workload">Adding a workload<a class="headerlink" href="#adding-a-workload" title="Permanent link">&para;</a></h4>
<p>To deploy a new workload on the cluster using gitops just add a kubernetes manifest to the repository. After a few
minutes you should see the resources appearing in the cluster.</p>
<h4 id="further-reading">Further reading<a class="headerlink" href="#further-reading" title="Permanent link">&para;</a></h4>
<p>To learn more about gitops and Flux, check the <a href="https://docs.fluxcd.io/en/latest/">Flux documentation</a>.</p>
<h3 id="installing-components-from-a-quick-start-profile">Installing components from a Quick Start profile<a class="headerlink" href="#installing-components-from-a-quick-start-profile" title="Permanent link">&para;</a></h3>
<p><code>eksctl</code> provides an application development Quick Star profile which can install the following components in your
cluster:
  - Metrics Server
  - Prometheus
  - Grafana
  - Kubernetes Dashboard
  - FluentD with connection to CloudWatch logs
  - CNI, present by default in EKS clusters
  - Cluster Autoscaler
  - ALB ingress controller
  - Podinfo as a demo application</p>
<p>To install those components the command <code>generate profile</code> can be used:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">EKSCTL_EXPERIMENTAL</span><span class="o">=</span><span class="k">true</span><span class="w"> </span><span class="n">eksctl</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="c1">--config-file=&lt;cluster_config_file&gt; --git-url git@github.com:weaveworks/eks-quickstart-app-dev.git --profile-path &lt;output_directory&gt;</span>
</pre></div>
</td></tr></table>

<p>For example:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ <span class="nv">EKSCTL_EXPERIMENTAL</span><span class="o">=</span><span class="nb">true</span> eksctl generate profile  --config-file <span class="m">01</span>-simple-cluster.yaml --git-url git@github.com:weaveworks/eks-quickstart-app-dev.git --profile-path my-gitops-repo/base/
<span class="o">[</span>ℹ<span class="o">]</span>  cloning repository <span class="s2">&quot;git@github.com:weaveworks/eks-quickstart-app-dev.git&quot;</span>:master
Cloning into <span class="s1">&#39;/tmp/quickstart-224631067&#39;</span>...
warning: templates not found /home/.../.git_template
remote: Enumerating objects: <span class="m">75</span>, <span class="k">done</span>.
remote: Counting objects: <span class="m">100</span>% <span class="o">(</span><span class="m">75</span>/75<span class="o">)</span>, <span class="k">done</span>.
remote: Compressing objects: <span class="m">100</span>% <span class="o">(</span><span class="m">63</span>/63<span class="o">)</span>, <span class="k">done</span>.
remote: Total <span class="m">75</span> <span class="o">(</span>delta <span class="m">25</span><span class="o">)</span>, reused <span class="m">49</span> <span class="o">(</span>delta <span class="m">11</span><span class="o">)</span>, pack-reused <span class="m">0</span>
Receiving objects: <span class="m">100</span>% <span class="o">(</span><span class="m">75</span>/75<span class="o">)</span>, <span class="m">19</span>.02 KiB <span class="p">|</span> <span class="m">1</span>.19 MiB/s, <span class="k">done</span>.
Resolving deltas: <span class="m">100</span>% <span class="o">(</span><span class="m">25</span>/25<span class="o">)</span>, <span class="k">done</span>.
<span class="o">[</span>ℹ<span class="o">]</span>  processing template files in repository
<span class="o">[</span>ℹ<span class="o">]</span>  writing new manifests to <span class="s2">&quot;base/&quot;</span>

$ tree my-gitops-repo/base
$ tree base/
base/
├── amazon-cloudwatch
│   ├── cloudwatch-agent-configmap.yaml
│   ├── cloudwatch-agent-daemonset.yaml
│   ├── cloudwatch-agent-rbac.yaml
│   ├── fluentd-configmap-cluster-info.yaml
│   ├── fluentd-configmap-fluentd-config.yaml
│   ├── fluentd-daemonset.yaml
│   └── fluentd-rbac.yaml
├── demo
│   └── helm-release.yaml
├── kubernetes-dashboard
│   ├── dashboard-metrics-scraper-deployment.yaml
│   ├── dashboard-metrics-scraper-service.yaml
│   ├── kubernetes-dashboard-configmap.yaml
│   ├── kubernetes-dashboard-deployment.yaml
│   ├── kubernetes-dashboard-rbac.yaml
│   ├── kubernetes-dashboard-secrets.yaml
│   └── kubernetes-dashboard-service.yaml
├── kube-system
│   ├── alb-ingress-controller-deployment.yaml
│   ├── alb-ingress-controller-rbac.yaml
│   ├── cluster-autoscaler-deployment.yaml
│   └── cluster-autoscaler-rbac.yaml
├── LICENSE
├── monitoring
│   ├── metrics-server.yaml
│   └── prometheus-operator.yaml
├── namespaces
│   ├── amazon-cloudwatch.yaml
│   ├── demo.yaml
│   ├── kubernetes-dashboard.yaml
│   └── monitoring.yaml
└── README.md
</pre></div>
</td></tr></table>

<p>After running the command, add, commit and push the files:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nb">cd</span> my-gitops-repo/
git add .
git commit -m <span class="s2">&quot;Add application development quick start components&quot;</span>
git push origin master
</pre></div>
</td></tr></table>

<p>After a few minutes, Flux and Helm should have installed all the components in your cluster.</p>
<h2 id="setting-up-gitops-in-a-repo-from-a-quick-start">Setting up gitops in a repo from a Quick Start<a class="headerlink" href="#setting-up-gitops-in-a-repo-from-a-quick-start" title="Permanent link">&para;</a></h2>
<p>Configuring gitops can be done easily with eksctl. The command <code>eksctl enable profile</code> takes an existing EKS cluster and
an empty repository and sets them up with gitops and a specified Quick Start profile. This means that with one command
the cluster will have all the components provided by the Quick Start profile installed in the cluster and you can enjoy
the advantages of gitops moving forward.</p>
<p>The basic command usage looks like this:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">EKSCTL_EXPERIMENTAL</span><span class="o">=</span><span class="k">true</span> <span class="n">eksctl</span> <span class="n">enable</span> <span class="n">profile</span> <span class="c1">--cluster &lt;cluster-name&gt; --region &lt;region&gt; --git-url=&lt;url_to_your_repo&gt; app-dev</span>
</pre></div>
</td></tr></table>

<p>This command will clone the specified repository in your current working directory and then it will follow these steps:</p>
<ol>
<li>install Flux, Helm and Tiller in the cluster and add the manifests of those components into the <code>flux/</code> folder in your repo</li>
<li>add the component manifests of the Quick Start profile to your repository inside the <code>base/</code> folder</li>
<li>commit the Quick Start files and push the changes to the origin remote</li>
<li>once you have given read and write access to your repository to the the SSH key printed by the command, Flux will install the components from the <code>base/</code> folder into your cluster</li>
</ol>
<p>Example:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">$</span> <span class="n">EKSCTL_EXPERIMENTAL</span><span class="o">=</span><span class="nb">true</span> <span class="n">eksctl</span> <span class="n">enable</span> <span class="n">profile</span> <span class="o">--</span><span class="n">cluster</span> <span class="n">production</span><span class="o">-</span><span class="n">cluster</span> <span class="o">--</span><span class="n">region</span> <span class="n">eu</span><span class="o">-</span><span class="n">north</span><span class="o">-</span><span class="mi">1</span> <span class="o">--</span><span class="n">git</span><span class="o">-</span><span class="n">url</span><span class="o">=</span><span class="n">git</span><span class="p">@</span><span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">myorg</span><span class="o">/</span><span class="n">production</span><span class="o">-</span><span class="n">kubernetes</span> <span class="n">app</span><span class="o">-</span><span class="n">dev</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Generating</span> <span class="n">public</span> <span class="n">key</span> <span class="n">infrastructure</span> <span class="k">for</span> <span class="n">the</span> <span class="n">Helm</span> <span class="n">Operator</span> <span class="n">and</span> <span class="n">Tiller</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>    <span class="n">this</span> <span class="n">may</span> <span class="n">take</span> <span class="n">up</span> <span class="n">to</span> <span class="n">a</span> <span class="n">minute</span><span class="p">,</span> <span class="n">please</span> <span class="n">be</span> <span class="n">patient</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span>  <span class="n">Public</span> <span class="n">key</span> <span class="n">infrastructure</span> <span class="n">files</span> <span class="n">were</span> <span class="n">written</span> <span class="n">into</span> <span class="n">directory</span> <span class="s">&quot;/tmp/eksctl-helm-pki786744152&quot;</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span>  <span class="n">please</span> <span class="n">move</span> <span class="n">the</span> <span class="n">files</span> <span class="n">into</span> <span class="n">a</span> <span class="n">safe</span> <span class="n">place</span> <span class="n">or</span> <span class="n">delete</span> <span class="n">them</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Generating</span> <span class="n">manifests</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Cloning</span> <span class="n">git</span><span class="p">@</span><span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">myorg</span><span class="o">/</span><span class="n">production</span><span class="o">-</span><span class="n">kubernetes</span>
<span class="n">Cloning</span> <span class="n">into</span> <span class="err">&#39;</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">eksctl</span><span class="o">-</span><span class="n">install</span><span class="o">-</span><span class="n">flux</span><span class="o">-</span><span class="n">clone</span><span class="o">-</span><span class="mi">615092439</span><span class="err">&#39;</span><span class="p">...</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Enumerating</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">114</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Counting</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">114</span><span class="o">/</span><span class="mi">114</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Compressing</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">94</span><span class="o">/</span><span class="mi">94</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Total</span> <span class="mi">114</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">36</span><span class="p">),</span> <span class="n">reused</span> <span class="mi">93</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">17</span><span class="p">),</span> <span class="n">pack</span><span class="o">-</span><span class="n">reused</span> <span class="mi">0</span>
<span class="n">Receiving</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">114</span><span class="o">/</span><span class="mi">114</span><span class="p">),</span> <span class="mf">31.43</span> <span class="n">KiB</span> <span class="o">|</span> <span class="mf">4.49</span> <span class="n">MiB</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Resolving</span> <span class="nl">deltas</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">36</span><span class="o">/</span><span class="mi">36</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Writing</span> <span class="n">Flux</span> <span class="n">manifests</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Applying</span> <span class="n">manifests</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;Namespace/flux&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Deployment.apps/flux-helm-operator&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Deployment.apps/flux&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Deployment.apps/memcached&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:ConfigMap/flux-helm-tls-ca-config&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Deployment.extensions/tiller-deploy&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Service/tiller-deploy&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;CustomResourceDefinition.apiextensions.k8s.io/helmreleases.helm.fluxcd.io&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Service/memcached&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:ServiceAccount/flux&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;ClusterRole.rbac.authorization.k8s.io/flux&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;ClusterRoleBinding.rbac.authorization.k8s.io/flux&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Secret/flux-git-deploy&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:ServiceAccount/flux-helm-operator&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;ClusterRole.rbac.authorization.k8s.io/flux-helm-operator&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;ClusterRoleBinding.rbac.authorization.k8s.io/flux-helm-operator&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:ServiceAccount/tiller&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;ClusterRoleBinding.rbac.authorization.k8s.io/tiller&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:ServiceAccount/helm&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Role.rbac.authorization.k8s.io/tiller-user&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;kube-system:RoleBinding.rbac.authorization.k8s.io/tiller-user-binding&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Applying</span> <span class="n">Helm</span> <span class="n">TLS</span> <span class="n">Secret</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Secret/flux-helm-tls-cert&quot;</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">created</span> <span class="s">&quot;flux:Secret/tiller-secret&quot;</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span>  <span class="nl">Note</span><span class="p">:</span> <span class="n">certificate</span> <span class="n">secrets</span> <span class="n">aren</span><span class="err">&#39;</span><span class="n">t</span> <span class="n">added</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Git</span> <span class="n">repository</span> <span class="k">for</span> <span class="n">security</span> <span class="n">reasons</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Waiting</span> <span class="k">for</span> <span class="n">Helm</span> <span class="n">Operator</span> <span class="n">to</span> <span class="n">start</span>
<span class="nl">ERROR</span><span class="p">:</span> <span class="n">logging</span> <span class="n">before</span> <span class="n">flag</span><span class="p">.</span><span class="nl">Parse</span><span class="p">:</span> <span class="n">E0822</span> <span class="mi">14</span><span class="o">:</span><span class="mi">45</span><span class="o">:</span><span class="mf">28.440236</span>   <span class="mi">17028</span> <span class="n">portforward</span><span class="p">.</span><span class="nl">go</span><span class="p">:</span><span class="mi">331</span><span class="p">]</span> <span class="n">an</span> <span class="n">error</span> <span class="n">occurred</span> <span class="n">forwarding</span> <span class="mi">44915</span> <span class="o">-&gt;</span> <span class="mi">3030</span><span class="o">:</span> <span class="n">error</span> <span class="n">forwarding</span> <span class="n">port</span> <span class="mi">3030</span> <span class="n">to</span> <span class="n">pod</span> <span class="mf">2f</span><span class="mi">6282</span><span class="n">bf597b345b3ffad8a0447bdd8515d91060335456591d759ad87a976ed2</span><span class="p">,</span> <span class="nl">uid</span> <span class="p">:</span> <span class="n">exit</span> <span class="n">status</span> <span class="mi">1</span><span class="o">:</span> <span class="mi">2019</span><span class="o">/</span><span class="mi">08</span><span class="o">/</span><span class="mi">22</span> <span class="mi">12</span><span class="o">:</span><span class="mi">45</span><span class="o">:</span><span class="mi">28</span> <span class="n">socat</span><span class="p">[</span><span class="mi">8131</span><span class="p">]</span> <span class="n">E</span> <span class="n">connect</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">AF</span><span class="o">=</span><span class="mi">2</span> <span class="mf">127.0.0.1</span><span class="o">:</span><span class="mi">3030</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span><span class="o">:</span> <span class="n">Connection</span> <span class="n">refused</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span>  <span class="n">Helm</span> <span class="n">Operator</span> <span class="n">is</span> <span class="n">not</span> <span class="n">ready</span> <span class="n">yet</span> <span class="p">(</span><span class="n">Get</span> <span class="nl">http</span><span class="p">:</span><span class="c1">//127.0.0.1:44915/healthz: EOF), retrying ...</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span>  <span class="n">Helm</span> <span class="n">Operator</span> <span class="n">is</span> <span class="n">not</span> <span class="n">ready</span> <span class="n">yet</span> <span class="p">(</span><span class="n">Get</span> <span class="nl">http</span><span class="p">:</span><span class="c1">//127.0.0.1:44915/healthz: EOF), retrying ...</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Helm</span> <span class="n">Operator</span> <span class="n">started</span> <span class="n">successfully</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">see</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//docs.fluxcd.io/projects/helm-operator for details on how to use the Helm Operator</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Waiting</span> <span class="k">for</span> <span class="n">Flux</span> <span class="n">to</span> <span class="n">start</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Flux</span> <span class="n">started</span> <span class="n">successfully</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">see</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//docs.fluxcd.io/projects/flux for details on how to use Flux</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Committing</span> <span class="n">and</span> <span class="n">pushing</span> <span class="n">manifests</span> <span class="n">to</span> <span class="n">git</span><span class="p">@</span><span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">myorg</span><span class="o">/</span><span class="n">production</span><span class="o">-</span><span class="n">kubernetes</span>
<span class="p">[</span><span class="n">master</span> <span class="mi">0985830</span><span class="p">]</span> <span class="n">Add</span> <span class="n">Initial</span> <span class="n">Flux</span> <span class="n">configuration</span>
 <span class="nl">Author</span><span class="p">:</span> <span class="n">Flux</span> <span class="o">&lt;&gt;</span>
 <span class="mi">13</span> <span class="n">files</span> <span class="n">changed</span><span class="p">,</span> <span class="mi">727</span> <span class="n">insertions</span><span class="p">(</span><span class="o">+</span><span class="p">)</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">flux</span><span class="o">-</span><span class="n">account</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">flux</span><span class="o">-</span><span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">flux</span><span class="o">-</span><span class="n">helm</span><span class="o">-</span><span class="n">operator</span><span class="o">-</span><span class="n">account</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">flux</span><span class="o">-</span><span class="n">helm</span><span class="o">-</span><span class="k">release</span><span class="o">-</span><span class="n">crd</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">flux</span><span class="o">-</span><span class="n">namespace</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">flux</span><span class="o">-</span><span class="n">secret</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">helm</span><span class="o">-</span><span class="n">operator</span><span class="o">-</span><span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">memcache</span><span class="o">-</span><span class="n">dep</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">memcache</span><span class="o">-</span><span class="n">svc</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">tiller</span><span class="o">-</span><span class="n">ca</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">configmap</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">tiller</span><span class="o">-</span><span class="n">dep</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">tiller</span><span class="o">-</span><span class="n">rbac</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">flux</span><span class="o">/</span><span class="n">tiller</span><span class="o">-</span><span class="n">svc</span><span class="p">.</span><span class="n">yaml</span>
<span class="n">Counting</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Delta</span> <span class="n">compression</span> <span class="n">using</span> <span class="n">up</span> <span class="n">to</span> <span class="mi">4</span> <span class="n">threads</span><span class="p">.</span>
<span class="n">Compressing</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">15</span><span class="o">/</span><span class="mi">15</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Writing</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">16</span><span class="o">/</span><span class="mi">16</span><span class="p">),</span> <span class="mf">8.23</span> <span class="n">KiB</span> <span class="o">|</span> <span class="mf">8.23</span> <span class="n">MiB</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Total</span> <span class="mi">16</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">1</span><span class="p">),</span> <span class="n">reused</span> <span class="mi">12</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">1</span><span class="p">)</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Resolving</span> <span class="nl">deltas</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="n">To</span> <span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">myorg</span><span class="o">/</span><span class="n">production</span><span class="o">-</span><span class="n">kubernetes</span>
   <span class="mi">3</span><span class="n">ea1fdc</span><span class="p">.</span><span class="mf">.0985830</span>  <span class="n">master</span> <span class="o">-&gt;</span> <span class="n">master</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">Flux</span> <span class="n">will</span> <span class="n">only</span> <span class="n">operate</span> <span class="n">properly</span> <span class="n">once</span> <span class="n">it</span> <span class="n">has</span> <span class="n">write</span><span class="o">-</span><span class="n">access</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Git</span> <span class="n">repository</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">please</span> <span class="n">configure</span> <span class="n">git</span><span class="p">@</span><span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">myorg</span><span class="o">/</span><span class="n">production</span><span class="o">-</span><span class="n">kubernetes</span> <span class="n">so</span> <span class="n">that</span> <span class="n">the</span> <span class="n">following</span> <span class="n">Flux</span> <span class="n">SSH</span> <span class="n">public</span> <span class="n">key</span> <span class="n">has</span> <span class="n">write</span> <span class="n">access</span> <span class="n">to</span> <span class="n">it</span>
<span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span> <span class="n">AAAAB3NzaC1yc2EAAAADAQABAAABAQDAdDG4LAEiEOTbT3XVL5sYf0Hy7T30PG2sFReIwrylR7syA</span><span class="o">+</span><span class="n">IU9GPf7azgjjbzbQc</span><span class="o">/</span><span class="mi">5</span><span class="n">BXTx2E0GotrzDkvCNScuYfw7wXKK87yr5jhPudpNubK9bFsKKwOj7wxO2XsUOceKVRhTKP7VJgpAliCCPK288HvQzIZfWEgbDQjhE0EnFgZVYXKkgye2Cc3MkwiYuZJtuynxipb5rPrY</span><span class="o">/</span><span class="mi">3</span><span class="n">Kjywk</span><span class="o">/</span><span class="n">vWxLeZ</span><span class="o">/</span><span class="n">hvv58mZSdRQwX6zbGGW1h70QA47B</span><span class="o">+</span><span class="n">W2076MBQQ1t0H0KKctuS8A1</span><span class="o">/</span><span class="n">n</span><span class="o">+</span><span class="n">aKjpD4Ne6lXqHDhqi25SBhJxK3zEXhskS9DMW8DYi1xHT2MCjE8HhiVBMRIITyTox</span>
<span class="n">Cloning</span> <span class="n">into</span> <span class="err">&#39;</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">gitops</span><span class="o">-</span><span class="n">repos</span><span class="o">/</span><span class="n">flux</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="mi">3</span><span class="err">&#39;</span><span class="p">...</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Enumerating</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">118</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Counting</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">118</span><span class="o">/</span><span class="mi">118</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Compressing</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">98</span><span class="o">/</span><span class="mi">98</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Total</span> <span class="mi">118</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">37</span><span class="p">),</span> <span class="n">reused</span> <span class="mi">96</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">17</span><span class="p">),</span> <span class="n">pack</span><span class="o">-</span><span class="n">reused</span> <span class="mi">0</span>
<span class="n">Receiving</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">118</span><span class="o">/</span><span class="mi">118</span><span class="p">),</span> <span class="mf">33.15</span> <span class="n">KiB</span> <span class="o">|</span> <span class="mf">1.44</span> <span class="n">MiB</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Resolving</span> <span class="nl">deltas</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">37</span><span class="o">/</span><span class="mi">37</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">cloning</span> <span class="n">repository</span> <span class="s">&quot;git@github.com:weaveworks/eks-quickstart-app-dev.git&quot;</span><span class="o">:</span><span class="n">master</span>
<span class="n">Cloning</span> <span class="n">into</span> <span class="err">&#39;</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">quickstart</span><span class="o">-</span><span class="mi">365477450</span><span class="err">&#39;</span><span class="p">...</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Enumerating</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">127</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Counting</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">127</span><span class="o">/</span><span class="mi">127</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Compressing</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">95</span><span class="o">/</span><span class="mi">95</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Total</span> <span class="mi">127</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">53</span><span class="p">),</span> <span class="n">reused</span> <span class="mi">92</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">30</span><span class="p">),</span> <span class="n">pack</span><span class="o">-</span><span class="n">reused</span> <span class="mi">0</span>
<span class="n">Receiving</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">127</span><span class="o">/</span><span class="mi">127</span><span class="p">),</span> <span class="mf">30.20</span> <span class="n">KiB</span> <span class="o">|</span> <span class="mf">351.00</span> <span class="n">KiB</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Resolving</span> <span class="nl">deltas</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">53</span><span class="o">/</span><span class="mi">53</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">processing</span> <span class="n">template</span> <span class="n">files</span> <span class="k">in</span> <span class="n">repository</span>
<span class="p">[</span><span class="err">ℹ</span><span class="p">]</span>  <span class="n">writing</span> <span class="n">new</span> <span class="n">manifests</span> <span class="n">to</span> <span class="s">&quot;/tmp/gitops-repos/flux-test-3/base&quot;</span>
<span class="p">[</span><span class="n">master</span> <span class="n">d0810f7</span><span class="p">]</span> <span class="n">Add</span> <span class="n">app</span><span class="o">-</span><span class="n">dev</span> <span class="n">quickstart</span> <span class="n">components</span>
 <span class="nl">Author</span><span class="p">:</span> <span class="n">Flux</span> <span class="o">&lt;&gt;</span>
 <span class="mi">27</span> <span class="n">files</span> <span class="n">changed</span><span class="p">,</span> <span class="mi">1207</span> <span class="n">insertions</span><span class="p">(</span><span class="o">+</span><span class="p">)</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">LICENSE</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">README</span><span class="p">.</span><span class="n">md</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">amazon</span><span class="o">-</span><span class="n">cloudwatch</span><span class="o">/</span><span class="n">cloudwatch</span><span class="o">-</span><span class="n">agent</span><span class="o">-</span><span class="n">configmap</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">amazon</span><span class="o">-</span><span class="n">cloudwatch</span><span class="o">/</span><span class="n">cloudwatch</span><span class="o">-</span><span class="n">agent</span><span class="o">-</span><span class="n">daemonset</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">amazon</span><span class="o">-</span><span class="n">cloudwatch</span><span class="o">/</span><span class="n">cloudwatch</span><span class="o">-</span><span class="n">agent</span><span class="o">-</span><span class="n">rbac</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">amazon</span><span class="o">-</span><span class="n">cloudwatch</span><span class="o">/</span><span class="n">fluentd</span><span class="o">-</span><span class="n">configmap</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">info</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">amazon</span><span class="o">-</span><span class="n">cloudwatch</span><span class="o">/</span><span class="n">fluentd</span><span class="o">-</span><span class="n">configmap</span><span class="o">-</span><span class="n">fluentd</span><span class="o">-</span><span class="n">config</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">amazon</span><span class="o">-</span><span class="n">cloudwatch</span><span class="o">/</span><span class="n">fluentd</span><span class="o">-</span><span class="n">daemonset</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">amazon</span><span class="o">-</span><span class="n">cloudwatch</span><span class="o">/</span><span class="n">fluentd</span><span class="o">-</span><span class="n">rbac</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">demo</span><span class="o">/</span><span class="n">helm</span><span class="o">-</span><span class="k">release</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">kube</span><span class="o">-</span><span class="n">system</span><span class="o">/</span><span class="n">alb</span><span class="o">-</span><span class="n">ingress</span><span class="o">-</span><span class="n">controller</span><span class="o">-</span><span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">kube</span><span class="o">-</span><span class="n">system</span><span class="o">/</span><span class="n">alb</span><span class="o">-</span><span class="n">ingress</span><span class="o">-</span><span class="n">controller</span><span class="o">-</span><span class="n">rbac</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">kube</span><span class="o">-</span><span class="n">system</span><span class="o">/</span><span class="n">cluster</span><span class="o">-</span><span class="n">autoscaler</span><span class="o">-</span><span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">kube</span><span class="o">-</span><span class="n">system</span><span class="o">/</span><span class="n">cluster</span><span class="o">-</span><span class="n">autoscaler</span><span class="o">-</span><span class="n">rbac</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">/</span><span class="n">dashboard</span><span class="o">-</span><span class="n">metrics</span><span class="o">-</span><span class="n">scraper</span><span class="o">-</span><span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">/</span><span class="n">dashboard</span><span class="o">-</span><span class="n">metrics</span><span class="o">-</span><span class="n">scraper</span><span class="o">-</span><span class="n">service</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">-</span><span class="n">configmap</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">-</span><span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">-</span><span class="n">rbac</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">-</span><span class="n">secrets</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="o">-</span><span class="n">service</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">monitoring</span><span class="o">/</span><span class="n">metrics</span><span class="o">-</span><span class="n">server</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">monitoring</span><span class="o">/</span><span class="n">prometheus</span><span class="o">-</span><span class="n">operator</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">namespaces</span><span class="o">/</span><span class="n">amazon</span><span class="o">-</span><span class="n">cloudwatch</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">namespaces</span><span class="o">/</span><span class="n">demo</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">namespaces</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">-</span><span class="n">dashboard</span><span class="p">.</span><span class="n">yaml</span>
 <span class="n">create</span> <span class="n">mode</span> <span class="mi">100644</span> <span class="n">base</span><span class="o">/</span><span class="n">namespaces</span><span class="o">/</span><span class="n">monitoring</span><span class="p">.</span><span class="n">yaml</span>
<span class="n">Counting</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Delta</span> <span class="n">compression</span> <span class="n">using</span> <span class="n">up</span> <span class="n">to</span> <span class="mi">4</span> <span class="n">threads</span><span class="p">.</span>
<span class="n">Compressing</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">27</span><span class="o">/</span><span class="mi">27</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Writing</span> <span class="nl">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">36</span><span class="o">/</span><span class="mi">36</span><span class="p">),</span> <span class="mf">11.17</span> <span class="n">KiB</span> <span class="o">|</span> <span class="mf">3.72</span> <span class="n">MiB</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">done</span><span class="p">.</span>
<span class="n">Total</span> <span class="mi">36</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">8</span><span class="p">),</span> <span class="n">reused</span> <span class="mi">27</span> <span class="p">(</span><span class="n">delta</span> <span class="mi">8</span><span class="p">)</span>
<span class="nl">remote</span><span class="p">:</span> <span class="n">Resolving</span> <span class="nl">deltas</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">8</span><span class="o">/</span><span class="mi">8</span><span class="p">),</span> <span class="n">done</span><span class="p">.</span>
<span class="n">To</span> <span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">myorg</span><span class="o">/</span><span class="n">production</span><span class="o">-</span><span class="n">kubernetes</span>
   <span class="mf">0985830.</span><span class="p">.</span><span class="n">d0810f7</span>  <span class="n">master</span> <span class="o">-&gt;</span> <span class="n">master</span>
</pre></div>
</td></tr></table>

<p>Now the ssh key printed above:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span> <span class="n">AAAAB3NzaC1yc2EAAAADAQABAAABAQDAdDG4LAEiEOTbT3XVL5sYf0Hy7T30PG2sFReIwrylR7syA</span><span class="o">+</span><span class="n">IU9GPf7azgjjbzbQc</span><span class="o">/</span><span class="mi">5</span><span class="n">BXTx2E0GotrzDkvCNScuYfw7wXKK87yr5jhPudpNubK9bFsKKwOj7wxO2XsUOceKVRhTKP7VJgpAliCCPK288HvQzIZfWEgbDQjhE0EnFgZVYXKkgye2Cc3MkwiYuZJtuynxipb5rPrY</span><span class="o">/</span><span class="mi">3</span><span class="n">Kjywk</span><span class="o">/</span><span class="n">vWxLeZ</span><span class="o">/</span><span class="n">hvv58mZSdRQwX6zbGGW1h70QA47B</span><span class="o">+</span><span class="n">W2076MBQQ1t0H0KKctuS8A1</span><span class="o">/</span><span class="n">n</span><span class="o">+</span><span class="n">aKjpD4Ne6lXqHDhqi25SBhJxK3zEXhskS9DMW8DYi1xHT2MCjE8HhiVBMRIITyTox</span>
</pre></div>
</td></tr></table>

<p>needs to be added as a deploy key to the chosen Github repository, in this case <code>github.com:myorg/production-kubernetes</code>.
Once that is done, Flux will pick up the changes in the repository with the Quick Start components and deploy them to the
 cluster. After a couple of minutes the pods should appear in the cluster:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ kubectl get pods --all-namespaces
NAMESPACE              NAME                                                      READY   STATUS                       RESTARTS   AGE
amazon-cloudwatch      cloudwatch-agent-qtdmc                                    <span class="m">1</span>/1     Running                      <span class="m">0</span>           4m28s
amazon-cloudwatch      fluentd-cloudwatch-4rwwr                                  <span class="m">1</span>/1     Running                      <span class="m">0</span>           4m28s
demo                   podinfo-75b8547f78-56dll                                  <span class="m">1</span>/1     Running                      <span class="m">0</span>          103s
flux                   flux-56b5664cdd-nfzx2                                     <span class="m">1</span>/1     Running                      <span class="m">0</span>          11m
flux                   flux-helm-operator-6bc7c85bb5-l2nzn                       <span class="m">1</span>/1     Running                      <span class="m">0</span>          11m
flux                   memcached-958f745c-dqllc                                  <span class="m">1</span>/1     Running                      <span class="m">0</span>          11m
flux                   tiller-deploy-7ccc4b4d45-w2mrt                            <span class="m">1</span>/1     Running                      <span class="m">0</span>          11m
kube-system            alb-ingress-controller-6b64bcbbd8-6l7kf                   <span class="m">1</span>/1     Running                      <span class="m">0</span>          4m28s
kube-system            aws-node-l49ct                                            <span class="m">1</span>/1     Running                      <span class="m">0</span>          14m
kube-system            cluster-autoscaler-5b8c96cd98-26z5f                       <span class="m">1</span>/1     Running                      <span class="m">0</span>          4m28s
kube-system            coredns-7d7755744b-4jkp6                                  <span class="m">1</span>/1     Running                      <span class="m">0</span>          21m
kube-system            coredns-7d7755744b-ls5d9                                  <span class="m">1</span>/1     Running                      <span class="m">0</span>          21m
kube-system            kube-proxy-wllff                                          <span class="m">1</span>/1     Running                      <span class="m">0</span>          14m
kubernetes-dashboard   dashboard-metrics-scraper-f7b5dbf7d-rm5z7                 <span class="m">1</span>/1     Running                      <span class="m">0</span>          4m28s
kubernetes-dashboard   kubernetes-dashboard-7447f48f55-94rhg                     <span class="m">1</span>/1     Running                      <span class="m">0</span>          4m28s
monitoring             alertmanager-prometheus-operator-alertmanager-0           <span class="m">2</span>/2     Running                      <span class="m">0</span>          78s
monitoring             metrics-server-7dfc675884-q9qps                           <span class="m">1</span>/1     Running                      <span class="m">0</span>          4m24s
monitoring             prometheus-operator-grafana-9bb769cf-pjk4r                <span class="m">2</span>/2     Running                      <span class="m">0</span>          89s
monitoring             prometheus-operator-kube-state-metrics-79f476bff6-r9m2s   <span class="m">1</span>/1     Running                      <span class="m">0</span>          89s
monitoring             prometheus-operator-operator-58fcb66576-6dwpg             <span class="m">1</span>/1     Running                      <span class="m">0</span>          89s
monitoring             prometheus-operator-prometheus-node-exporter-tllwl        <span class="m">1</span>/1     Running                      <span class="m">0</span>          89s
monitoring             prometheus-prometheus-operator-prometheus-0               <span class="m">3</span>/3     Running                      <span class="m">1</span>          72s
</pre></div>
</td></tr></table>

<p>All CLI arguments:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Default value</th>
<th>Type</th>
<th>Required</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--cluster</code></td>
<td></td>
<td>string</td>
<td>required</td>
<td>name of the EKS cluster to add the nodegroup to</td>
</tr>
<tr>
<td><code>--name</code></td>
<td></td>
<td>string</td>
<td>required</td>
<td>name or URL of the Quick Start profile. For example, app-dev</td>
</tr>
<tr>
<td><name positional argument></td>
<td></td>
<td>string</td>
<td>required</td>
<td>same as <code>--name</code></td>
</tr>
<tr>
<td><code>--git-url</code></td>
<td></td>
<td>string</td>
<td>required</td>
<td>URL</td>
</tr>
<tr>
<td><code>--git-branch</code></td>
<td>master</td>
<td>string</td>
<td>optional</td>
<td>Git branch</td>
</tr>
<tr>
<td><code>--output-path</code></td>
<td>./</td>
<td>string</td>
<td>optional</td>
<td>Path</td>
</tr>
<tr>
<td><code>--git-user</code></td>
<td>Flux</td>
<td>string</td>
<td>optional</td>
<td>Username</td>
</tr>
<tr>
<td><code>--git-email</code></td>
<td></td>
<td>string</td>
<td>optional</td>
<td>Email</td>
</tr>
<tr>
<td><code>--git-private-ssh-key-path</code></td>
<td></td>
<td>string</td>
<td>optional</td>
<td>Optional path to the private SSH key to use with Git</td>
</tr>
</tbody>
</table>
<h2 id="creating-your-own-quick-start-profile">Creating your own Quick Start profile<a class="headerlink" href="#creating-your-own-quick-start-profile" title="Permanent link">&para;</a></h2>
<p>A Quick Start profile is a Git repository that contains Kubernetes manifests that can be installed in a cluster using
gitops (through <a href="https://docs.fluxcd.io/en/latest/">Flux</a>).</p>
<p>These manifests, will probably need some information about the cluster they will be installed in, such as the cluster
name or the AWS region. That's why they are templated using <a href="https://golang.org/pkg/text/template/">Go templates</a>.</p>
<blockquote>
<p>Please bear in mind that this is an experimental feature and therefore the chosen templating technology can be changed
before the feature becomes stable.</p>
</blockquote>
<p>The variables that can be templated are shown below:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Template</th>
</tr>
</thead>
<tbody>
<tr>
<td>cluster name</td>
<td><code>{{ .ClusterName }}</code></td>
</tr>
<tr>
<td>cluster region</td>
<td><code>{{ .Region }}</code></td>
</tr>
</tbody>
</table>
<p>For example, we could create a config map using these variables:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">data</span><span class="p">:</span>
  <span class="nt">cluster.name</span><span class="p">:</span> <span class="p p-Indicator">{{</span> <span class="nv">.ClusterName</span> <span class="p p-Indicator">}}</span>
  <span class="nt">logs.region</span><span class="p">:</span> <span class="p p-Indicator">{{</span> <span class="nv">.Region</span> <span class="p p-Indicator">}}</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cluster-info</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-namespace</span>
</pre></div>
</td></tr></table>

<p>Write this into a file with the extension <code>*.yaml.tmpl</code> and commit it to your Quick Start repository.
Files with this extension get processed by eksctl before committing them to the user's gitops repository, while the rest get copied unmodified.</p>
<p>Regarding the folder structure inside the Quick Start repository, we recommend using a folder for each <code>namespace</code> and
one file per Kubernetes resource.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">repository</span><span class="o">-</span><span class="n">name</span><span class="o">/</span>
<span class="err">├──</span> <span class="n">kube</span><span class="o">-</span><span class="k">system</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">ingress</span><span class="o">-</span><span class="n">controller</span><span class="o">-</span><span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span><span class="p">.</span><span class="n">tmpl</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">ingress</span><span class="o">-</span><span class="n">controller</span><span class="o">-</span><span class="n">rbac</span><span class="p">.</span><span class="n">yaml</span><span class="p">.</span><span class="n">tmpl</span>
<span class="err">└──</span> <span class="n">alerting</span>
    <span class="err">├──</span> <span class="n">alerting</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span>
    <span class="err">├──</span> <span class="n">alerting</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">service</span><span class="p">.</span><span class="n">yaml</span><span class="p">.</span><span class="n">tmpl</span>
    <span class="err">├──</span> <span class="n">monitoring</span><span class="o">-</span><span class="n">sidecar</span><span class="o">-</span><span class="n">deployment</span><span class="p">.</span><span class="n">yaml</span>
    <span class="err">├──</span> <span class="n">monitoring</span><span class="o">-</span><span class="n">sidecar</span><span class="o">-</span><span class="n">service</span><span class="p">.</span><span class="n">yaml</span><span class="p">.</span><span class="n">tmpl</span>
    <span class="err">├──</span> <span class="k">cluster</span><span class="o">-</span><span class="n">info</span><span class="o">-</span><span class="n">configmap</span><span class="p">.</span><span class="n">yaml</span><span class="p">.</span><span class="n">tmpl</span>
    <span class="err">└──</span> <span class="n">alerting</span><span class="o">-</span><span class="n">namespace</span><span class="p">.</span><span class="n">yaml</span>
</pre></div>
</td></tr></table>

<p>Note that some files have the extension <code>*.yaml</code> while others have <code>*.yaml.tmpl</code>. The last ones are the ones that can
contain template actions while the former are plain <code>yaml</code> files.</p>
<p>These files can now be committed and pushed to your Quick Start repository, for example <code>git@github.com:my-org/production-infra</code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">cd</span> <span class="n">repository</span><span class="o">-</span><span class="n">name</span><span class="o">/</span>
<span class="n">git</span> <span class="k">add</span> <span class="p">.</span>
<span class="n">git</span> <span class="k">commit</span> <span class="o">-</span><span class="n">m</span> <span class="ss">&quot;Add component templates&quot;</span>
<span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="n">master</span>
</pre></div>
</td></tr></table>

<p>Now that the templates are in the remote repository, the Quick Start is ready to be used with <code>eksctl enable profile</code>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">EKSCTL_EXPERIMENTAL</span><span class="o">=</span><span class="k">true</span><span class="w"> </span><span class="n">eksctl</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="c1">--cluster team1 --region eu-west-1 --git-url git@github.com:my-org/team1-cluster --git-email alice@my-org.com git@github.com:my-org/production-infra</span>
</pre></div>
</td></tr></table>

<p>In this example we provide <code>github.com:my-org/production-infra</code> as the Quick Start profile and
<code>github.com:my-org/team1-cluster</code> as the gitops repository that is connected to the Flux instance in the cluster named
<code>cluster1</code>.</p>
<p>For a full example of a Quick Start profile, check out <a href="https://github.com/weaveworks/eks-quickstart-app-dev">App Dev</a>.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../faq/" title="FAQ" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                FAQ
              </span>
            </div>
          </a>
        
        
          <a href="../../../examples/reusing-iam-and-vpc/" title="Custom IAM and VPC config" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Custom IAM and VPC config
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 Weaveworks
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://twitter.com/weaveworks" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
    
  </body>
</html>